<div class="theo-doi-don-hang">
  <div class="thanh-tai-khoan">
    <!-- Avatar v√† th√¥ng tin ng∆∞·ªùi d√πng -->
    <div class="thanh-tai-khoan__info-wrapper">
      <div class="thanh-tai-khoan__avatar-wrapper">
        <img src="avatar-placeholder.png" alt="User Avatar" class="thanh-tai-khoan__avatar">
      </div>
      <div class="thanh-tai-khoan__details">
        <h3 class="thanh-tai-khoan__username">nguyenngoctrinh</h3>
        <button class="thanh-tai-khoan__edit-button">
          <img src="pencil-icon.png" alt="Edit Icon" class="thanh-tai-khoan__edit-icon">
          S·ª≠a h·ªì s∆°
        </button>
      </div>
    </div>
    <hr class="thanh-tai-khoan__separator">
    <!-- Danh s√°ch -->
     <!-- T√†i kho·∫£n c·ªßa t√¥i -->
    <!-- Danh s√°ch -->
    <ul class="thanh-tai-khoan-danh-sach">
      <!-- T√†i kho·∫£n c·ªßa t√¥i -->
      <li class="thanh-tai-khoan-danh-sach-item" (click)="toggleDropdown('tai-khoan')">
        <img src="user-icon.png" alt="User Icon" class="thanh-tai-khoan-danh-sach-icon">
        T√†i kho·∫£n c·ªßa t√¥i
      </li>
      <li class="thanh-tai-khoan-danh-sach-dropdown" *ngIf="dropdown === 'tai-khoan'" (click)="navigateToSection('ho-so')">H·ªì s∆°</li>
      <li class="thanh-tai-khoan-danh-sach-dropdown" *ngIf="dropdown === 'tai-khoan'" (click)="navigateToSection('dia-chi')">ƒê·ªãa ch·ªâ</li>
      <li class="thanh-tai-khoan-danh-sach-dropdown" *ngIf="dropdown === 'tai-khoan'" (click)="navigateToSection('doi-ma-pin')">ƒê·ªïi m√£ PIN</li>
      <li class="thanh-tai-khoan-danh-sach-dropdown" *ngIf="dropdown === 'tai-khoan'" (click)="navigateToSection('xoa-tai-khoan')">X√≥a t√†i kho·∫£n</li>
      
      <!-- Theo d√µi ƒë∆°n h√†ng -->
      <li class="thanh-tai-khoan-danh-sach-item" (click)="navigateToSection('theo-doi-don-hang')">
        <img src="list-icon.png" alt="List Icon" class="thanh-tai-khoan-danh-sach-icon">
        Theo d√µi ƒë∆°n h√†ng
      </li>
      <!-- Vi·∫øt s√°ch truy·ªán -->
      <li class="thanh-tai-khoan-danh-sach-item" (click)="toggleDropdown('viet-sach')">
        <img src="book-icon.png" alt="Book Icon" class="thanh-tai-khoan-danh-sach-icon">
        Vi·∫øt s√°ch/truy·ªán
      </li>
      <li class="thanh-tai-khoan-danh-sach-dropdown" *ngIf="dropdown === 'viet-sach'" (click)="navigateToSection('truyen-moi')">Truy·ªán m·ªõi</li>
      <li class="thanh-tai-khoan-danh-sach-dropdown" *ngIf="dropdown === 'viet-sach'" (click)="navigateToSection('viet-tiep')">Vi·∫øt ti·∫øp</li>
      <!-- ƒêƒÉng xu·∫•t -->
      <li class="thanh-tai-khoan-danh-sach-item" (click)="navigateToSection('dang-xuat')">
        <img src="logout-icon.png" alt="Logout Icon" class="thanh-tai-khoan-danh-sach-icon">
        ƒêƒÉng xu·∫•t
      </li>
      <!-- <li *ngIf="dropdown === 'tai-khoan'"></li>
      <li *ngIf="dropdown === 'viet-sach'"></li> -->
    </ul>
  </div>
  
<!-- Trang "H·ªì s∆°" -->
<div class="content-container" *ngIf="activeSection === 'ho-so'">
    <h2 class="section-title">H·ªì s∆° c·ªßa t√¥i</h2>
    <p class="section-subtitle">Qu·∫£n l√Ω th√¥ng tin h·ªì s∆° ƒë·ªÉ b·∫£o m·∫≠t t√†i kho·∫£n</p>
    <div class="ho-so--noi-dung">
      <div class="ho-so--form">
        <div class="ho-so--input-group">
          <label for="fullName">T√™n ƒëƒÉng nh·∫≠p</label>
          <input type="text" id="fullName" [(ngModel)]="userProfile.fullName" placeholder="Nguy·ªÖn Ng·ªçc Trinh" />
        </div>
        <div class="ho-so--input-group">
          <label for="email">Email</label>
          <input type="email" id="email" [(ngModel)]="userProfile.email" placeholder="Th√™m email" />
        </div>
        <div class="ho-so--input-group">
          <label for="phone">S·ªë ƒëi·ªán tho·∫°i</label>
          <input type="text" id="phone" [(ngModel)]="userProfile.phone" placeholder="834 376 426 259" />
        </div>
        <div class="ho-so--input-group">
          <label for="gender">Gi·ªõi t√≠nh</label>
          <select id="gender" [(ngModel)]="userProfile.gender">
            <option value="Nam">Nam</option>
            <option value="N·ªØ" selected>N·ªØ</option>
            <option value="Kh√°c">Kh√°c</option>
          </select>
        </div>
        <div class="ho-so--input-group">
          <label for="birthDate">Ng√†y sinh</label>
          <input type="text" id="birthDate" [(ngModel)]="userProfile.birthDate" placeholder="**/****/2004" />
        </div>
        <div class="ho-so--button-wrapper">
          <button class="ho-so--save-button" (click)="saveProfile()">L∆∞u</button>
        </div>
      </div>
      <div class="ho-so--avatar">
        <div class="ho-so--avatar-placeholder"></div>
        <button class="ho-so--avatar-button">Ch·ªçn ·∫£nh</button>
        <p>Dung l∆∞·ª£ng file t·ªëi ƒëa 1 MB<br />ƒê·ªãnh d·∫°ng: .JPEG, .PNG</p>
      </div>
    </div>
</div>

<!-- Trang "ƒê·ªãa ch·ªâ" -->
<div class="content-container" *ngIf="activeSection === 'dia-chi'">
    <h2 class="section-title">ƒê·ªãa ch·ªâ c·ªßa t√¥i</h2>
    <div class="dia-chi--header">
      <button class="dia-chi--add-button" (click)="addNewAddress()">+ Th√™m ƒë·ªãa ch·ªâ m·ªõi</button>
    </div>
    <div class="dia-chi--list">
      <div class="dia-chi--item" *ngFor="let address of userAddresses; let i = index">
        <div class="dia-chi--info">
          <div class="dia-chi--input-group">
            <input type="text" [(ngModel)]="address.name" placeholder="Nguy·ªÖn Ng·ªçc Trinh" />
          </div>
          <div class="dia-chi--input-group">
            <input type="text" [(ngModel)]="address.phone" placeholder="834 376 426 259" />
          </div>
          <div class="dia-chi--input-group">
            <input type="text" [(ngModel)]="address.location" placeholder="KTX Khu B ƒêHQG, ƒê√¥ng H√≤a, Th√†nh Ph·ªë Dƒ© An, B√¨nh D∆∞∆°ng" />
          </div>
          <span class="dia-chi--default" *ngIf="address.isDefault">M·∫∑c ƒë·ªãnh</span>
        </div>
        <div class="dia-chi--actions">
          <button class="dia-chi--action-button dia-chi--delete-button" (click)="deleteAddress(i)">X√≥a</button>
          <button class="dia-chi--action-button" (click)="saveAddress(i)">C·∫≠p nh·∫≠t</button>
          <button class="dia-chi--action-button" (click)="setDefaultAddress(i)" [disabled]="address.isDefault">Thi·∫øt l·∫≠p m·∫∑c ƒë·ªãnh</button>

        </div>
      </div>
    </div>
</div>

<!-- Trang "ƒê·ªïi m√£ PIN" -->
<div class="content-container" *ngIf="activeSection === 'doi-ma-pin'">
    <h2 class="section-title">ƒê·ªïi m√£ PIN</h2>
    <p class="section-subtitle">ƒê·ªÉ b·∫£o m·∫≠t t√†i kho·∫£n, vui l√≤ng kh√¥ng chia s·∫ª m√£ PIN cho ng∆∞·ªùi kh√°c</p>
    <div class="doi-ma-pin--form">
      <div class="doi-ma-pin--input-group">
        <label for="newPin">M√£ PIN m·ªõi</label>
        <div class="doi-ma-pin--input-wrapper">
          <input type="password" id="newPin" [(ngModel)]="pinData.newPin" placeholder="M√£ PIN m·ªõi" />
          <span class="doi-ma-pin--toggle-icon" (click)="togglePinVisibility('newPin')">üëÅÔ∏è</span>
        </div>
      </div>
      <div class="doi-ma-pin--input-group">
        <label for="confirmPin">X√°c nh·∫≠n m√£ PIN</label>
        <div class="doi-ma-pin--input-wrapper">
          <input type="password" id="confirmPin" [(ngModel)]="pinData.confirmPin" placeholder="X√°c nh·∫≠n m√£ PIN" />
          <span class="doi-ma-pin--toggle-icon" (click)="togglePinVisibility('confirmPin')">üëÅÔ∏è</span>
        </div>
      </div>
      <div class="doi-ma-pin--button-wrapper">
        <button class="doi-ma-pin--save-button" (click)="changePin()">X√°c nh·∫≠n</button>
      </div>
    </div>
</div>

<!-- Trang "X√≥a t√†i kho·∫£n" -->
<div class="content-container" *ngIf="activeSection === 'xoa-tai-khoan'">
    <h2 class="section-title">X√≥a t√†i kho·∫£n</h2>
    <p class="section-subtitle">Y√™u c·∫ßu x√≥a t√†i kho·∫£n</p>
    <div class="xoa-tai-khoan--content">
      <p class="xoa-tai-khoan--warning">Khi y√™u c·∫ßu x√≥a t√†i kho·∫£n, b·∫°n s·∫Ω kh√¥ng th·ªÉ truy c·∫≠p v√†o t√†i kho·∫£n n√†y n·ªØa.</p>
      <label class="xoa-tai-khoan--checkbox">
        <input type="checkbox" [(ngModel)]="deleteAccountConfirmation" />
        T√¥i ƒë·ªìng √Ω x√≥a t√†i kho·∫£n
      </label>
      <div class="xoa-tai-khoan--button-wrapper">
        <button class="xoa-tai-khoan--delete-button" (click)="confirmDeleteAccount()">X√≥a b·ªè</button>
      </div>
    </div>
</div>
  <div class="thanh-don-hang" *ngIf="activeSection === 'theo-doi-don-hang'">
    <!-- Thanh tr·∫°ng th√°i -->
    <div class="thanh-trang-thai">
      <div
        class="thanh-trang-thai-item"
        [ngClass]="{'active': selectedTab === 'tat-ca'}"
        (click)="selectTab('tat-ca')"
      >T·∫•t c·∫£</div>
      <div
        class="thanh-trang-thai-item"
        [ngClass]="{'active': selectedTab === 'cho-xac-nhan'}"
        (click)="selectTab('cho-xac-nhan')"
      >Ch·ªù x√°c nh·∫≠n</div>
      <div
        class="thanh-trang-thai-item"
        [ngClass]="{'active': selectedTab === 'van-chuyen'}"
        (click)="selectTab('van-chuyen')"
      >V·∫≠n chuy·ªÉn</div>
      <div
        class="thanh-trang-thai-item"
        [ngClass]="{'active': selectedTab === 'cho-giao-hang'}"
        (click)="selectTab('cho-giao-hang')"
      >Ch·ªù giao h√†ng</div>
      <div
        class="thanh-trang-thai-item"
        [ngClass]="{'active': selectedTab === 'hoan-thanh'}"
        (click)="selectTab('hoan-thanh')"
      >Ho√†n th√†nh</div>
      <div
        class="thanh-trang-thai-item"
        [ngClass]="{'active': selectedTab === 'da-huy'}"
        (click)="selectTab('da-huy')"
      >ƒê√£ h·ªßy</div>
    </div>
    <!-- Thanh t√¨m ki·∫øm -->
    <div class="thanh-tim-kiem-trang-thai">
      <span><img src="search.png" alt="Search Icon" class="thanh-tim-kiem-bieu-tuong"></span>
      <input type="text" class="thanh-tim-kiem-input" placeholder="B·∫°n c√≥ th·ªÉ t√¨m ki·∫øm theo T√™n s·∫£n ph·∫©m, M√£ ƒë∆°n h√†ng" (input)="onSearchInput($event)">
    </div>

    <!-- N·ªôi dung ch√≠nh (danh s√°ch ƒë∆°n h√†ng) -->
    <div class="theo-doi-don-hang--chinh">
      <div class="theo-doi-don-hang--don-hang-item" *ngFor="let order of getFilteredOrders()">
        <!-- Ph·∫ßn tr√™n -->
        <div class="theo-doi-don-hang--phan-tren" (click)="viewOrderDetails(order)" style="cursor: pointer;">
          <img [src]="order.imageUrl" [alt]="order.title" class="theo-doi-don-hang--don-hang-anh">
          <div class="theo-doi-don-hang--don-hang-chi-tiet">
            <!-- H√†ng 1 -->
            <div class="theo-doi-don-hang--hang">
              <h3 class="theo-doi-don-hang--don-hang-tieu-de">{{ order.title }}</h3>
              <p class="theo-doi-don-hang--don-hang-trang-thai">{{ getDisplayStatus(order.status) }}</p>
            </div>
            <!-- H√†ng 2 -->
            <div class="theo-doi-don-hang--hang">
              <p class="theo-doi-don-hang--don-hang-so-luong">S·ªë l∆∞·ª£ng: {{ order.quantity }}</p>
              <p class="theo-doi-don-hang--don-hang-gia">
                <span class="gia-goc">{{ order.originalPrice | number }}ƒë</span> {{ order.discountedPrice | number }}ƒë
              </p>
            </div>
          </div>
        </div>
        <!-- ƒê∆∞·ªùng ph√¢n c√°ch -->
        <hr class="theo-doi-don-hang--separator">
        <!-- Ph·∫ßn d∆∞·ªõi -->
        <div class="theo-doi-don-hang--phan-duoi">
          <!-- Placeholder ƒë·ªÉ gi·ªØ v·ªã tr√≠ -->
          <div class="theo-doi-don-hang--ghi-chu-placeholder">
            <!-- Ghi ch√∫ thay ƒë·ªïi theo tr·∫°ng th√°i -->
            <p class="theo-doi-don-hang--ghi-chu" *ngIf="order.status !== 'ƒê√£ h·ªßy' && order.status === 'Ch·ªù x√°c nh·∫≠n'">
              Ng∆∞·ªùi b√°n ƒëang x√°c nh·∫≠n ƒë∆°n h√†ng c·ªßa b·∫°n
            </p>
            <p class="theo-doi-don-hang--ghi-chu" *ngIf="order.status !== 'ƒê√£ h·ªßy' && order.status === 'V·∫≠n chuy·ªÉn' && order.confirmationDate">
              ƒê∆°n h√†ng s·∫Ω ƒë∆∞·ª£c giao cho ƒë∆°n v·ªã v·∫≠n chuy·ªÉn tr∆∞·ªõc ng√†y {{ getExpectedDeliveryDate(order.confirmationDate) }}
            </p>
            <p class="theo-doi-don-hang--ghi-chu" *ngIf="order.status !== 'ƒê√£ h·ªßy' && order.status === 'Ch·ªù giao h√†ng'">
              Vui l√≤ng ch·ªâ nh·∫•n "ƒê√£ nh·∫≠n ƒë∆∞·ª£c h√†ng" khi ƒë∆°n h√†ng ƒë√£ ƒë∆∞·ª£c giao ƒë·∫øn b·∫°n v√† s·∫£n ph·∫©m nh·∫≠n ƒë∆∞·ª£c kh√¥ng c√≥ v·∫•n ƒë·ªÅ n√†o
            </p>
            <p class="theo-doi-don-hang--ghi-chu" *ngIf="order.status !== 'ƒê√£ h·ªßy' && order.status === 'Ho√†n th√†nh' && !order.isRated">
              Vui l√≤ng ƒë√°nh gi√° s·∫£n ph·∫©m
            </p>
          </div>
          <!-- N√∫t h√†nh ƒë·ªông -->
          <div class="theo-doi-don-hang--don-hang-hanh-dong">
            <!-- N√∫t ƒë·∫ßu ti√™n thay ƒë·ªïi theo tr·∫°ng th√°i -->
            <button *ngIf="order.status === 'cho-xac-nhan'" class="theo-doi-don-hang--don-hang-button" (click)="openCancelPopup(order)">
              H·ªßy ƒë∆°n
            </button>
            <button *ngIf="order.status === 'van-chuyen' || order.status === 'cho-giao-hang'" class="theo-doi-don-hang--don-hang-button" [ngClass]="{'btn-disabled': !order.isDelivered}" [disabled]="!order.isDelivered" (click)="confirmReceived(order)">
              ƒê√£ nh·∫≠n h√†ng
            </button>
            <button *ngIf="order.status === 'hoan-thanh' && !order.isRated" class="theo-doi-don-hang--don-hang-button" (click)="openRatingPopup(order)">
              ƒê√°nh gi√°
            </button>
            <button *ngIf="order.status === 'hoan-thanh' && order.isRated" class="theo-doi-don-hang--don-hang-button" (click)="viewRating(order)">
              Xem ƒë√°nh gi√°
            </button>
            <button *ngIf="order.status === 'da-huy'" class="theo-doi-don-hang--don-hang-button" (click)="buyAgain(order)">
              Mua l·∫°i
            </button>

            <!-- N√∫t c·ªë ƒë·ªãnh "Li√™n h·ªá" -->
            <button class="theo-doi-don-hang--don-hang-button" [routerLink]="['/lien-he']">
              Li√™n h·ªá
            </button>
          </div>

          <!-- Th√†nh ti·ªÅn -->
          <div class="theo-doi-don-hang--don-hang-tong">
            <p class="theo-doi-don-hang--don-hang-tong">Th√†nh ti·ªÅn:</p>
            <p class="theo-doi-don-hang--don-hang-gia-tong">{{ order.totalPrice | number }}ƒë</p>
          </div>
        </div>
      </div>
    </div>
    <!-- N·ªôi dung kh√°c (placeholder cho c√°c section kh√°c) -->
    <!-- <div *ngIf="activeSection === 'tai-khoan-cua-toi'">N·ªôi dung T√†i kho·∫£n c·ªßa t√¥i</div>
    <div *ngIf="activeSection === 'viet-sach-truyen'">N·ªôi dung Vi·∫øt s√°ch/truy·ªán</div>
    <div *ngIf="activeSection === 'dang-xuat'">
      <button (click)="onLogout()">X√°c nh·∫≠n ƒëƒÉng xu·∫•t</button>
    </div> -->

  </div>
  
  <!-- Chi ti·∫øt ƒë∆°n h√†ng -->
<div class="thanh-don-hang" *ngIf="activeSection === 'chi-tiet-don-hang' && selectedOrder">
  <!-- Thanh tr√™n c√πng -->
  <div class="chi-tiet-don-hang--thanh-trang-thai">
    <div class="chi-tiet-don-hang--tro-lai" (click)="navigateToSection('theo-doi-don-hang')"> < TR·ªû L·∫†I</div>
    <div class="chi-tiet-don-hang--trang-thai">{{ getDetailedStatus(selectedOrder.status) | uppercase }}</div>
  </div>

  <!-- N·ªôi dung chi ti·∫øt -->
  <div class="chi-tiet-don-hang--noi-dung">
    <!-- Ph·∫ßn head -->
    <div class="chi-tiet-don-hang--head">
      <p class="chi-tiet-don-hang--ma-don">M√É ƒê∆†N H√ÄNG: {{ selectedOrder.orderId }}</p>
      <p class="chi-tiet-don-hang--du-kien" *ngIf="selectedOrder.confirmationDate">
        ƒê∆°n h√†ng d·ª± ki·∫øn ƒë∆∞·ª£c giao tr∆∞·ªõc ng√†y {{ getExpectedDeliveryDate(selectedOrder.confirmationDate) }}
      </p>
    </div>

    <!-- Ph·∫ßn ti·∫øn ƒë·ªô ƒë∆°n h√†ng -->
     <div class="chi-tiet-don-hang--tien-do">
      <div class="chi-tiet-don-hang--tien-do-item">
        <img [src]="isStatusReached(selectedOrder, 'ƒê∆°n h√†ng ƒë√£ ƒë∆∞·ª£c ƒë·∫∑t th√†nh c√¥ng') ? 'dat-hang-thanh-cong-green.png' : 'dat-hang-thanh-cong-grey.png'" alt="Order Placed" class="chi-tiet-don-hang--tien-do-icon">
        <p class="chi-tiet-don-hang--tien-do-trang-thai">ƒê∆°n h√†ng ƒë√£ ƒë·∫∑t</p>
        <p class="chi-tiet-don-hang--tien-do-thoi-gian">{{ getStatusDate(selectedOrder, 'ƒê∆°n h√†ng ƒë√£ ƒë∆∞·ª£c ƒë·∫∑t th√†nh c√¥ng') }}</p>
      </div>
      <div class="chi-tiet-don-hang--tien-do-item">
        <img [src]="isStatusReached(selectedOrder, 'ƒê√£ x√°c nh·∫≠n ƒë∆°n h√†ng') ? 'xac-nhan-green.png' : 'xac-nhan-gray.png'" alt="Confirmed" class="chi-tiet-don-hang--tien-do-icon">
        <p class="chi-tiet-don-hang--tien-do-trang-thai">ƒê√£ x√°c nh·∫≠n ƒë∆°n h√†ng</p>
        <p class="chi-tiet-don-hang--tien-do-thoi-gian">{{ getStatusDate(selectedOrder, 'ƒê√£ x√°c nh·∫≠n ƒë∆°n h√†ng') }}</p>
      </div>
      <div class="chi-tiet-don-hang--tien-do-item">
        <img [src]="isStatusReached(selectedOrder, 'ƒê√£ giao cho ƒë∆°n v·ªã v·∫≠n chuy·ªÉn') ? 'van-chuyen-green.png' : 'van-chuyen-gray.png'" alt="Delivered" class="chi-tiet-don-hang--tien-do-icon">
        <p class="chi-tiet-don-hang--tien-do-trang-thai">ƒê√£ giao cho ƒë∆°n v·ªã v·∫≠n chuy·ªÉn</p>
        <p class="chi-tiet-don-hang--tien-do-thoi-gian">{{ getStatusDate(selectedOrder, 'ƒê√£ giao cho ƒë∆°n v·ªã v·∫≠n chuy·ªÉn') }}</p>
      </div>
      <div class="chi-tiet-don-hang--tien-do-item">
        <img [src]="isStatusReached(selectedOrder, 'ƒê√£ nh·∫≠n ƒë∆∞·ª£c h√†ng') ? 'nhan-hang-green.png' : 'nhan-hang-gray.png'" alt="Received" class="chi-tiet-don-hang--tien-do-icon">
        <p class="chi-tiet-don-hang--tien-do-trang-thai">ƒê√£ nh·∫≠n ƒë∆∞·ª£c h√†ng</p>
        <p class="chi-tiet-don-hang--tien-do-thoi-gian">{{ getStatusDate(selectedOrder, 'ƒê√£ nh·∫≠n ƒë∆∞·ª£c h√†ng') }}</p>
      </div>
      <div class="chi-tiet-don-hang--tien-do-item">
        <img [src]="isStatusReached(selectedOrder, 'ƒê√°nh gi√°') ? 'danh-gia-green.png' : 'danh-gia-gray.png'" alt="Rating" class="chi-tiet-don-hang--tien-do-icon">
        <p class="chi-tiet-don-hang--tien-do-trang-thai">ƒê√°nh gi√°</p>
        <p class="chi-tiet-don-hang--tien-do-thoi-gian">{{ getStatusDate(selectedOrder, 'ƒê√°nh gi√°') }}</p>
      </div>
    </div>

    <!-- Ph·∫ßn l·ªô tr√¨nh ƒë∆°n h√†ng -->
    <div class="chi-tiet-don-hang--lo-trinh">
      <h3 class="chi-tiet-don-hang--lo-trinh-tieu-de">L·ªô tr√¨nh ƒë∆°n h√†ng</h3>
      <div class="chi-tiet-don-hang--lo-trinh-noi-dung">
        <div class="chi-tiet-don-hang--lo-trinh-thoi-gian">
          <p *ngFor="let entry of selectedOrder.timeline">{{ entry.date }}</p>
        </div>
        <div class="chi-tiet-don-hang--lo-trinh-mo-ta">
          <p *ngFor="let entry of selectedOrder.timeline">{{ entry.action }}</p>
        </div>
      </div>
    </div>

    <!-- ƒê∆∞·ªùng ph√¢n c√°ch -->
    <hr class="theo-doi-don-hang--separator">

    <!-- Ph·∫ßn chi ti·∫øt ƒë∆°n h√†ng -->
    <div class="chi-tiet-don-hang--chi-tiet">
      <h3 class="chi-tiet-don-hang--chi-tiet-tieu-de">Chi ti·∫øt ƒë∆°n h√†ng</h3>
      <p class="chi-tiet-don-hang--dia-chi-tieu-de">ƒê·ªãa ch·ªâ nh·∫≠n h√†ng</p>
      <p class="chi-tiet-don-hang--dia-chi">{{ selectedOrder.addressName }}</p>
      <p class="chi-tiet-don-hang--dia-chi">{{ selectedOrder.addressPhone }}</p>
      <p class="chi-tiet-don-hang--dia-chi">{{ selectedOrder.addressLocation }}</p>

      <div class="chi-tiet-don-hang--san-pham">
        <img [src]="selectedOrder.imageUrl" [alt]="selectedOrder.title" class="chi-tiet-don-hang--san-pham-anh">
        <div class="chi-tiet-don-hang--san-pham-chi-tiet">
          <div class="chi-tiet-don-hang--san-pham-hang">
            <h3 class="chi-tiet-don-hang--san-pham-tieu-de">{{ selectedOrder.title }}</h3>
            <div></div>
          </div>
          <div class="chi-tiet-don-hang--san-pham-hang">
            <p class="chi-tiet-don-hang--san-pham-so-luong">S·ªë l∆∞·ª£ng: {{ selectedOrder.quantity }}</p>
            <p class="chi-tiet-don-hang--san-pham-gia">
              <span class="gia-goc">{{ selectedOrder.originalPrice | number }}ƒë</span> {{ selectedOrder.discountedPrice | number }}ƒë
            </p>
          </div>
        </div>
      </div>
    </div>

    <!-- ƒê∆∞·ªùng ph√¢n c√°ch -->
    <hr class="theo-doi-don-hang--separator">

    <!-- Ph·∫ßn chi ph√≠ -->
    <div class="chi-tiet-don-hang--chi-phi">
      <div class="chi-tiet-don-hang--chi-phi-cot-trong"></div>
      <div class="chi-tiet-don-hang--chi-phi-ten">
        <p>T·ªïng ti·ªÅn h√†ng:</p>
        <p>Ph√≠ v·∫≠n chuy·ªÉn:</p>
        <p>Gi·∫£m gi√°:</p>
        <p>Th√†nh ti·ªÅn:</p>
        <p>Ph∆∞∆°ng th·ª©c thanh to√°n:</p>
      </div>
      <div class="chi-tiet-don-hang--chi-phi-gia">
        <p>{{ (selectedOrder.discountedPrice * selectedOrder.quantity) | number }}ƒë</p>
        <p>{{ selectedOrder.shippingFee | number }}ƒë</p>
        <p>{{ selectedOrder.discount | number }}ƒë</p>
        <p>{{ selectedOrder.totalPrice | number }}ƒë</p>
        <p>{{ selectedOrder.paymentMethod }}</p>
      </div>
    </div>

    <!-- N√∫t h√†nh ƒë·ªông -->
    <div class="chi-tiet-don-hang--hanh-dong">
      <button *ngIf="selectedOrder.status === 'cho-xac-nhan'" class="theo-doi-don-hang--don-hang-button" (click)="openCancelPopup(selectedOrder)">
        H·ªßy ƒë∆°n
      </button>
      <button *ngIf="selectedOrder.status === 'van-chuyen' || selectedOrder.status === 'cho-giao-hang'" class="theo-doi-don-hang--don-hang-button" [ngClass]="{'btn-disabled': !selectedOrder.isDelivered}" [disabled]="!selectedOrder.isDelivered" (click)="confirmReceived(selectedOrder)">
        ƒê√£ nh·∫≠n h√†ng
      </button>
      <button *ngIf="selectedOrder.status === 'hoan-thanh' && !selectedOrder.isRated" class="theo-doi-don-hang--don-hang-button" (click)="openRatingPopup(selectedOrder)">
        ƒê√°nh gi√°
      </button>
      <button *ngIf="selectedOrder.status === 'hoan-thanh' && selectedOrder.isRated" class="theo-doi-don-hang--don-hang-button" (click)="viewRating(selectedOrder)">
        Xem ƒë√°nh gi√°
      </button>
      <button *ngIf="selectedOrder.status === 'da-huy'" class="theo-doi-don-hang--don-hang-button" (click)="buyAgain(selectedOrder)">
        Mua l·∫°i
      </button>
      <button class="theo-doi-don-hang--don-hang-button" [routerLink]="['/lien-he']">
        Li√™n h·ªá
      </button>
    </div>
  </div>
</div>
</div>

<!-- Popup ƒë√°nh gi√° -->
<div class="rating-popup-overlay" *ngIf="showRatingPopup" (click)="closeRatingPopup()"></div>
<div class="rating-popup" *ngIf="showRatingPopup">
  <h3 class="rating-popup--title">ƒê√°nh Gi√° S·∫£n Ph·∫©m</h3>
  <div class="rating-popup--product">
    <img [src]="ratingOrder?.imageUrl" [alt]="ratingOrder?.title" class="rating-popup--product-image">
    <div class="rating-popup--product-details">
      <p class="rating-popup--product-title">{{ ratingOrder?.title }}</p>
      <p class="rating-popup--product-quantity">S·ªë l∆∞·ª£ng: {{ ratingOrder?.quantity }}</p>
    </div>
  </div>
  <div class="rating-popup--stars">
    <span class="rating-popup--stars-label">Ch·∫•t l∆∞·ª£ng s·∫£n ph·∫©m</span>
    <div class="rating-popup--stars-container">
      <span
        *ngFor="let star of [1, 2, 3, 4, 5]; let i = index"
        class="rating-popup--star"
        [ngClass]="{'filled': i + 1 <= (hoverRating || currentRating)}"
        (mouseover)="onStarHover(i + 1)"
        (mouseleave)="onStarLeave()"
        (click)="onStarClick(i + 1)"
      >‚òÖ</span>
    </div>
    <span class="rating-popup--stars-text">{{ getRatingText(hoverRating || currentRating) }}</span>
  </div>
  <textarea
    class="rating-popup--textarea"
    placeholder="H√£y chia s·∫ª nh·∫≠n ƒë·ªãnh c·ªßa b·∫°n th√≠ch v·ªÅ s·∫£n ph·∫©m n√†y v·ªõi nh·ªØng ng∆∞·ªùi mua kh√°c nh√©"
    [(ngModel)]="ratingText"
  ></textarea>
  <div class="rating-popup--actions">
    <button class="rating-popup--button rating-popup--button-cancel" (click)="closeRatingPopup()">Quay l·∫°i</button>
    <button class="rating-popup--button rating-popup--button-submit" (click)="submitRating()">G·ª≠i ƒë√°nh gi√°</button>
  </div>
</div>

<!-- Popup th√¥ng b√°o th√†nh c√¥ng -->
<div class="success-popup" *ngIf="showSuccessPopup">
  <div class="success-popup--icon"><img src="danh-gia-thanh-cong.png" alt="" class="success-popup--icon"></div>
  <p class="success-popup--message">C·∫£m ∆°n b·∫°n ƒë√£ ƒë√°nh gi√°!</p>
</div>

<!-- Popup xem ƒë√°nh gi√° -->
<div class="view-rating-popup-overlay" *ngIf="showViewRatingPopup" (click)="closeViewRatingPopup()"></div>
<div class="view-rating-popup" *ngIf="showViewRatingPopup">
  <h3 class="view-rating-popup--title">ƒê√°nh gi√° c·ªßa t√¥i</h3>
  <div class="view-rating-popup--product">
    <img [src]="ratingOrder?.imageUrl" [alt]="ratingOrder?.title" class="view-rating-popup--product-image">
    <div class="view-rating-popup--product-details">
      <p class="view-rating-popup--product-title">{{ ratingOrder?.title }}</p>
      <p class="view-rating-popup--product-quantity">S·ªë l∆∞·ª£ng: {{ ratingOrder?.quantity }}</p>
    </div>
  </div>
  <hr class="view-rating-popup--separator">
  <div class="view-rating-popup--review">
    <div class="view-rating-popup--user">
      <div class="view-rating-popup--user-avatar"></div>
      <div class="view-rating-popup--user-details">
        <p class="view-rating-popup--user-name">nguyenngoctrinh</p>
        <div class="view-rating-popup--user-stars">
          <span *ngFor="let star of [1, 2, 3, 4, 5]; let i = index"
                class="view-rating-popup--star"
                [ngClass]="{'filled': i + 1 <= (ratingOrder?.rating || 0)}">‚òÖ</span>
        </div>
      </div>
    </div>
    <p class="view-rating-popup--review-text">{{ ratingOrder?.ratingText }}</p>
    <p class="view-rating-popup--review-date">{{ ratingOrder?.ratingDate }}</p>
  </div>
  <div class="view-rating-popup--actions">
    <button *ngIf="ratingOrder && !ratingOrder.isEdited" class="view-rating-popup--button view-rating-popup--button-edit" (click)="openEditRatingPopup(ratingOrder!)">S·ª≠a</button>
    <button class="view-rating-popup--button view-rating-popup--button-close" (click)="closeViewRatingPopup()">Tho√°t</button>
  </div>
</div>

<!-- Popup s·ª≠a ƒë√°nh gi√° -->
<div class="rating-popup-overlay" *ngIf="showEditRatingPopup" (click)="closeRatingPopup()"></div>
<div class="rating-popup" *ngIf="showEditRatingPopup">
  <h3 class="rating-popup--title">S·ª≠a ƒê√°nh Gi√° S·∫£n Ph·∫©m</h3>
  <div class="rating-popup--product">
    <img [src]="ratingOrder?.imageUrl" [alt]="ratingOrder?.title" class="rating-popup--product-image">
    <div class="rating-popup--product-details">
      <p class="rating-popup--product-title">{{ ratingOrder?.title }}</p>
      <p class="rating-popup--product-quantity">S·ªë l∆∞·ª£ng: {{ ratingOrder?.quantity }}</p>
    </div>
  </div>
  <div class="rating-popup--stars">
    <span class="rating-popup--stars-label">Ch·∫•t l∆∞·ª£ng s·∫£n ph·∫©m</span>
    <div class="rating-popup--stars-container">
      <span
        *ngFor="let star of [1, 2, 3, 4, 5]; let i = index"
        class="rating-popup--star"
        [ngClass]="{'filled': i + 1 <= (hoverRating || currentRating)}"
        (mouseover)="onStarHover(i + 1)"
        (mouseleave)="onStarLeave()"
        (click)="onStarClick(i + 1)"
      >‚òÖ</span>
    </div>
    <span class="rating-popup--stars-text">{{ getRatingText(hoverRating || currentRating) }}</span>
  </div>
  <textarea
    class="rating-popup--textarea"
    placeholder="H√£y chia s·∫ª nh·∫≠n ƒë·ªãnh c·ªßa b·∫°n th√≠ch v·ªÅ s·∫£n ph·∫©m n√†y v·ªõi nh·ªØng ng∆∞·ªùi mua kh√°c nh√©"
    [(ngModel)]="ratingText"
  ></textarea>
  <div class="rating-popup--actions">
    <button class="rating-popup--button rating-popup--button-cancel" (click)="cancelEditRating()">Quay l·∫°i</button>
    <button class="rating-popup--button rating-popup--button-submit" (click)="updateRating()">C·∫≠p nh·∫≠t</button>
  </div>
</div>

<!-- Popup "L√Ω do h·ªßy" -->
<div class="cancel-popup-overlay" *ngIf="showCancelPopup" (click)="closeCancelPopup()"></div>
<div class="cancel-popup" *ngIf="showCancelPopup">
  <h3 class="cancel-popup--title">L√Ω do h·ªßy</h3>
  <p class="cancel-popup--message">N·∫øu b·∫°n x√°c nh·∫≠n h·ªßy, to√†n b·ªô ƒë∆°n h√†ng s·∫Ω ƒë∆∞·ª£c h·ªßy. Tr∆∞·ªùng h·ª£p b·∫°n ƒë√£ thanh to√°n, ti·ªÅn s·∫Ω ƒë∆∞·ª£c ho√†n v·ªÅ v√≠ t√†i kho·∫£n ng√¢n h√†ng c·ªßa b·∫°n trong v√≤ng 24 gi·ªù. M·ªçi v·∫•n ƒë·ªÅ v·ªÅ ho√†n ti·ªÅn, b·∫°n vui l√≤ng li√™n h·ªá ch√∫ng t√¥i ƒë·ªÉ ƒë∆∞·ª£c h·ªó tr·ª£.</p>
  <div class="cancel-popup--options">
    <label class="cancel-popup--option">
      <input type="radio" name="cancelReason" value="T√¥i t√¨m th·∫•y s·∫£n ph·∫©m r·∫ª h∆°n" [(ngModel)]="cancelReason">
      T√¥i t√¨m th·∫•y s·∫£n ph·∫©m r·∫ª h∆°n
    </label>
    <label class="cancel-popup--option">
      <input type="radio" name="cancelReason" value="Ng∆∞·ªùi b√°n kh√¥ng tr·∫£ l·ªùi th·∫Øc m·∫Øc, y√™u c·∫ßu c·ªßa t√¥i" [(ngModel)]="cancelReason">
      Ng∆∞·ªùi b√°n kh√¥ng tr·∫£ l·ªùi th·∫Øc m·∫Øc, y√™u c·∫ßu c·ªßa t√¥i
    </label>
    <label class="cancel-popup--option">
      <input type="radio" name="cancelReason" value="T√¥i mu·ªën thay ƒë·ªïi ƒë·ªãa ch·ªâ giao h√†ng (s·ªë l∆∞·ª£ng, th√™m, gi·∫£m gi√°...)" [(ngModel)]="cancelReason">
      T√¥i mu·ªën thay ƒë·ªïi ƒë·ªãa ch·ªâ giao h√†ng (s·ªë l∆∞·ª£ng, th√™m, gi·∫£m gi√°...)
    </label>
    <label class="cancel-popup--option">
      <input type="radio" name="cancelReason" value="T√¥i kh√¥ng c·∫ßn nhu c·∫ßu mua n·ªØa" [(ngModel)]="cancelReason">
      T√¥i kh√¥ng c·∫ßn nhu c·∫ßu mua n·ªØa
    </label>
  </div>
  <div class="cancel-popup--actions">
    <button class="cancel-popup--button cancel-popup--button-back" (click)="closeCancelPopup()">Quay l·∫°i</button>
    <button class="cancel-popup--button cancel-popup--button-confirm" (click)="confirmCancelOrder()">H·ªßy ƒë∆°n</button>
  </div>
</div>

<!-- Popup "H·ªßy ƒë∆°n th√†nh c√¥ng" -->
<div class="cancel-success-popup" *ngIf="showCancelSuccessPopup">
  <div class="cancel-success-popup--icon"><img src="danh-gia-thanh-cong.png" alt=""></div>
  <p class="cancel-success-popup--message">H·ªßy ƒë∆°n th√†nh c√¥ng</p>
  <p *ngIf="cancelOrderToProcess?.paymentMethod === 'Chuy·ªÉn kho·∫£n ng√¢n h√†ng'" class="cancel-success-popup--submessage">
    Ti·ªÅn s·∫Ω ƒë∆∞·ª£c ho√†n v·ªÅ v√≠ t√†i kho·∫£n ng√¢n h√†ng c·ªßa b·∫°n trong v√≤ng 24 gi·ªù.
  </p>
</div>



