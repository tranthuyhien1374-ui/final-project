<div class="theo-doi-don-hang">
  <div class="thanh-tai-khoan">
    <!-- Avatar vÃ  thÃ´ng tin ngÆ°á»i dÃ¹ng -->
    <div class="thanh-tai-khoan__info-wrapper">
      <div class="thanh-tai-khoan__avatar-wrapper">
        <img src="avatar-placeholder.png" alt="User Avatar" class="thanh-tai-khoan__avatar">
      </div>
      <div class="thanh-tai-khoan__details">
        <h3 class="thanh-tai-khoan__username">nguyenngoctrinh</h3>
        <button class="thanh-tai-khoan__edit-button">
          <img src="pencil-icon.png" alt="Edit Icon" class="thanh-tai-khoan__edit-icon">
          Sá»­a há»“ sÆ¡
        </button>
      </div>
    </div>
    <hr class="thanh-tai-khoan__separator">
    <!-- Danh sÃ¡ch -->
     <!-- TÃ i khoáº£n cá»§a tÃ´i -->
    <!-- Danh sÃ¡ch -->
    <ul class="thanh-tai-khoan-danh-sach">
      <!-- TÃ i khoáº£n cá»§a tÃ´i -->
      <li class="thanh-tai-khoan-danh-sach-item" (click)="toggleDropdown('tai-khoan')">
        <img src="user-icon.png" alt="User Icon" class="thanh-tai-khoan-danh-sach-icon">
        TÃ i khoáº£n cá»§a tÃ´i
      </li>
      <li class="thanh-tai-khoan-danh-sach-dropdown" *ngIf="dropdown === 'tai-khoan'" (click)="navigateToSection('ho-so')">Há»“ sÆ¡</li>
      <li class="thanh-tai-khoan-danh-sach-dropdown" *ngIf="dropdown === 'tai-khoan'" (click)="navigateToSection('dia-chi')">Äá»‹a chá»‰</li>
      <li class="thanh-tai-khoan-danh-sach-dropdown" *ngIf="dropdown === 'tai-khoan'" (click)="navigateToSection('doi-ma-pin')">Äá»•i mÃ£ PIN</li>
      <li class="thanh-tai-khoan-danh-sach-dropdown" *ngIf="dropdown === 'tai-khoan'" (click)="navigateToSection('xoa-tai-khoan')">XÃ³a tÃ i khoáº£n</li>
      
      <!-- Theo dÃµi Ä‘Æ¡n hÃ ng -->
      <li class="thanh-tai-khoan-danh-sach-item" (click)="navigateToSection('theo-doi-don-hang')">
        <img src="list-icon.png" alt="List Icon" class="thanh-tai-khoan-danh-sach-icon">
        Theo dÃµi Ä‘Æ¡n hÃ ng
      </li>
      <!-- Viáº¿t sÃ¡ch truyá»‡n -->
      <li class="thanh-tai-khoan-danh-sach-item" (click)="toggleDropdown('viet-sach')">
        <img src="book-icon.png" alt="Book Icon" class="thanh-tai-khoan-danh-sach-icon">
        Viáº¿t sÃ¡ch/truyá»‡n
      </li>
      <li class="thanh-tai-khoan-danh-sach-dropdown" *ngIf="dropdown === 'viet-sach'" (click)="navigateToSection('truyen-moi')">Truyá»‡n má»›i</li>
      <li class="thanh-tai-khoan-danh-sach-dropdown" *ngIf="dropdown === 'viet-sach'" (click)="navigateToSection('viet-tiep')">Viáº¿t tiáº¿p</li>
      <!-- ÄÄƒng xuáº¥t -->
      <li class="thanh-tai-khoan-danh-sach-item" (click)="navigateToSection('dang-xuat')">
        <img src="logout-icon.png" alt="Logout Icon" class="thanh-tai-khoan-danh-sach-icon">
        ÄÄƒng xuáº¥t
      </li>
      <!-- <li *ngIf="dropdown === 'tai-khoan'"></li>
      <li *ngIf="dropdown === 'viet-sach'"></li> -->
    </ul>
  </div>
  
<!-- Trang "Há»“ sÆ¡" -->
<div class="content-container" *ngIf="activeSection === 'ho-so'">
    <h2 class="section-title">Há»“ sÆ¡ cá»§a tÃ´i</h2>
    <p class="section-subtitle">Quáº£n lÃ½ thÃ´ng tin há»“ sÆ¡ Ä‘á»ƒ báº£o máº­t tÃ i khoáº£n</p>
    <div class="ho-so--noi-dung">
      <div class="ho-so--form">
        <div class="ho-so--input-group">
          <label for="fullName">TÃªn Ä‘Äƒng nháº­p</label>
          <input type="text" id="fullName" [(ngModel)]="userProfile.fullName" placeholder="Nguyá»…n Ngá»c Trinh" />
        </div>
        <div class="ho-so--input-group">
          <label for="email">Email</label>
          <input type="email" id="email" [(ngModel)]="userProfile.email" placeholder="ThÃªm email" />
        </div>
        <div class="ho-so--input-group">
          <label for="phone">Sá»‘ Ä‘iá»‡n thoáº¡i</label>
          <input type="text" id="phone" [(ngModel)]="userProfile.phone" placeholder="834 376 426 259" />
        </div>
        <div class="ho-so--input-group">
          <label for="gender">Giá»›i tÃ­nh</label>
          <select id="gender" [(ngModel)]="userProfile.gender">
            <option value="Nam">Nam</option>
            <option value="Ná»¯" selected>Ná»¯</option>
            <option value="KhÃ¡c">KhÃ¡c</option>
          </select>
        </div>
        <div class="ho-so--input-group">
          <label for="birthDate">NgÃ y sinh</label>
          <input type="text" id="birthDate" [(ngModel)]="userProfile.birthDate" placeholder="**/****/2004" />
        </div>
        <div class="ho-so--button-wrapper">
          <button class="ho-so--save-button" (click)="saveProfile()">LÆ°u</button>
        </div>
      </div>
      <div class="ho-so--avatar">
        <div class="ho-so--avatar-placeholder"></div>
        <button class="ho-so--avatar-button">Chá»n áº£nh</button>
        <p>Dung lÆ°á»£ng file tá»‘i Ä‘a 1 MB<br />Äá»‹nh dáº¡ng: .JPEG, .PNG</p>
      </div>
    </div>
</div>

<!-- Trang "Äá»‹a chá»‰" -->
<div class="content-container" *ngIf="activeSection === 'dia-chi'">
    <h2 class="section-title">Äá»‹a chá»‰ cá»§a tÃ´i</h2>
    <div class="dia-chi--header">
      <button class="dia-chi--add-button" (click)="addNewAddress()">+ ThÃªm Ä‘á»‹a chá»‰ má»›i</button>
    </div>
    <div class="dia-chi--list">
      <div class="dia-chi--item" *ngFor="let address of userAddresses; let i = index">
        <div class="dia-chi--info">
          <div class="dia-chi--input-group">
            <input type="text" [(ngModel)]="address.name" placeholder="Nguyá»…n Ngá»c Trinh" />
          </div>
          <div class="dia-chi--input-group">
            <input type="text" [(ngModel)]="address.phone" placeholder="834 376 426 259" />
          </div>
          <div class="dia-chi--input-group">
            <input type="text" [(ngModel)]="address.location" placeholder="KTX Khu B ÄHQG, ÄÃ´ng HÃ²a, ThÃ nh Phá»‘ DÄ© An, BÃ¬nh DÆ°Æ¡ng" />
          </div>
          <span class="dia-chi--default" *ngIf="address.isDefault">Máº·c Ä‘á»‹nh</span>
        </div>
        <div class="dia-chi--actions">
          <button class="dia-chi--action-button dia-chi--delete-button" (click)="deleteAddress(i)">XÃ³a</button>
          <button class="dia-chi--action-button" (click)="saveAddress(i)">Cáº­p nháº­t</button>
          <button class="dia-chi--action-button" (click)="setDefaultAddress(i)" [disabled]="address.isDefault">Thiáº¿t láº­p máº·c Ä‘á»‹nh</button>

        </div>
      </div>
    </div>
</div>

<!-- Trang "Äá»•i mÃ£ PIN" -->
<div class="content-container" *ngIf="activeSection === 'doi-ma-pin'">
    <h2 class="section-title">Äá»•i mÃ£ PIN</h2>
    <p class="section-subtitle">Äá»ƒ báº£o máº­t tÃ i khoáº£n, vui lÃ²ng khÃ´ng chia sáº» mÃ£ PIN cho ngÆ°á»i khÃ¡c</p>
    <div class="doi-ma-pin--form">
      <div class="doi-ma-pin--input-group">
        <label for="newPin">MÃ£ PIN má»›i</label>
        <div class="doi-ma-pin--input-wrapper">
          <input type="password" id="newPin" [(ngModel)]="pinData.newPin" placeholder="MÃ£ PIN má»›i" />
          <span class="doi-ma-pin--toggle-icon" (click)="togglePinVisibility('newPin')">ğŸ‘ï¸</span>
        </div>
      </div>
      <div class="doi-ma-pin--input-group">
        <label for="confirmPin">XÃ¡c nháº­n mÃ£ PIN</label>
        <div class="doi-ma-pin--input-wrapper">
          <input type="password" id="confirmPin" [(ngModel)]="pinData.confirmPin" placeholder="XÃ¡c nháº­n mÃ£ PIN" />
          <span class="doi-ma-pin--toggle-icon" (click)="togglePinVisibility('confirmPin')">ğŸ‘ï¸</span>
        </div>
      </div>
      <div class="doi-ma-pin--button-wrapper">
        <button class="doi-ma-pin--save-button" (click)="changePin()">XÃ¡c nháº­n</button>
      </div>
    </div>
</div>

<!-- Trang "XÃ³a tÃ i khoáº£n" -->
<div class="content-container" *ngIf="activeSection === 'xoa-tai-khoan'">
    <h2 class="section-title">XÃ³a tÃ i khoáº£n</h2>
    <p class="section-subtitle">YÃªu cáº§u xÃ³a tÃ i khoáº£n</p>
    <div class="xoa-tai-khoan--content">
      <p class="xoa-tai-khoan--warning">Khi yÃªu cáº§u xÃ³a tÃ i khoáº£n, báº¡n sáº½ khÃ´ng thá»ƒ truy cáº­p vÃ o tÃ i khoáº£n nÃ y ná»¯a.</p>
      <label class="xoa-tai-khoan--checkbox">
        <input type="checkbox" [(ngModel)]="deleteAccountConfirmation" />
        TÃ´i Ä‘á»“ng Ã½ xÃ³a tÃ i khoáº£n
      </label>
      <div class="xoa-tai-khoan--button-wrapper">
        <button class="xoa-tai-khoan--delete-button" (click)="confirmDeleteAccount()">XÃ³a bá»</button>
      </div>
    </div>
</div>
  <div class="thanh-don-hang" *ngIf="activeSection === 'theo-doi-don-hang'">
    <!-- Thanh tráº¡ng thÃ¡i -->
    <div class="thanh-trang-thai">
      <div
        class="thanh-trang-thai-item"
        [ngClass]="{'active': selectedTab === 'tat-ca'}"
        (click)="selectTab('tat-ca')"
      >Táº¥t cáº£</div>
      <div
        class="thanh-trang-thai-item"
        [ngClass]="{'active': selectedTab === 'cho-xac-nhan'}"
        (click)="selectTab('cho-xac-nhan')"
      >Chá» xÃ¡c nháº­n</div>
      <div
        class="thanh-trang-thai-item"
        [ngClass]="{'active': selectedTab === 'van-chuyen'}"
        (click)="selectTab('van-chuyen')"
      >Váº­n chuyá»ƒn</div>
      <div
        class="thanh-trang-thai-item"
        [ngClass]="{'active': selectedTab === 'cho-giao-hang'}"
        (click)="selectTab('cho-giao-hang')"
      >Chá» giao hÃ ng</div>
      <div
        class="thanh-trang-thai-item"
        [ngClass]="{'active': selectedTab === 'hoan-thanh'}"
        (click)="selectTab('hoan-thanh')"
      >HoÃ n thÃ nh</div>
      <div
        class="thanh-trang-thai-item"
        [ngClass]="{'active': selectedTab === 'da-huy'}"
        (click)="selectTab('da-huy')"
      >ÄÃ£ há»§y</div>
    </div>
    <!-- Thanh tÃ¬m kiáº¿m -->
    <div class="thanh-tim-kiem-trang-thai">
      <span><img src="search.png" alt="Search Icon" class="thanh-tim-kiem-bieu-tuong"></span>
      <input type="text" class="thanh-tim-kiem-input" placeholder="Báº¡n cÃ³ thá»ƒ tÃ¬m kiáº¿m theo TÃªn sáº£n pháº©m, MÃ£ Ä‘Æ¡n hÃ ng" (input)="onSearchInput($event)">
    </div>

    <!-- Ná»™i dung chÃ­nh (danh sÃ¡ch Ä‘Æ¡n hÃ ng) -->
    <div class="theo-doi-don-hang--chinh">
      <div class="theo-doi-don-hang--don-hang-item" *ngFor="let order of getFilteredOrders()">
        <!-- Pháº§n trÃªn -->
        <div class="theo-doi-don-hang--phan-tren" (click)="viewOrderDetails(order)" style="cursor: pointer;">
          <img [src]="order.imageUrl" [alt]="order.title" class="theo-doi-don-hang--don-hang-anh">
          <div class="theo-doi-don-hang--don-hang-chi-tiet">
            <!-- HÃ ng 1 -->
            <div class="theo-doi-don-hang--hang">
              <h3 class="theo-doi-don-hang--don-hang-tieu-de">{{ order.title }}</h3>
              <p class="theo-doi-don-hang--don-hang-trang-thai">{{ getDisplayStatus(order.status) }}</p>
            </div>
            <!-- HÃ ng 2 -->
            <div class="theo-doi-don-hang--hang">
              <p class="theo-doi-don-hang--don-hang-so-luong">Sá»‘ lÆ°á»£ng: {{ order.quantity }}</p>
              <p class="theo-doi-don-hang--don-hang-gia">
                <span class="gia-goc">{{ order.originalPrice | number }}Ä‘</span> {{ order.discountedPrice | number }}Ä‘
              </p>
            </div>
          </div>
        </div>
        <!-- ÄÆ°á»ng phÃ¢n cÃ¡ch -->
        <hr class="theo-doi-don-hang--separator">
        <!-- Pháº§n dÆ°á»›i -->
        <div class="theo-doi-don-hang--phan-duoi">
          <!-- Placeholder Ä‘á»ƒ giá»¯ vá»‹ trÃ­ -->
          <div class="theo-doi-don-hang--ghi-chu-placeholder">
            <!-- Ghi chÃº thay Ä‘á»•i theo tráº¡ng thÃ¡i -->
            <p class="theo-doi-don-hang--ghi-chu" *ngIf="order.status !== 'ÄÃ£ há»§y' && order.status === 'Chá» xÃ¡c nháº­n'">
              NgÆ°á»i bÃ¡n Ä‘ang xÃ¡c nháº­n Ä‘Æ¡n hÃ ng cá»§a báº¡n
            </p>
            <p class="theo-doi-don-hang--ghi-chu" *ngIf="order.status !== 'ÄÃ£ há»§y' && order.status === 'Váº­n chuyá»ƒn' && order.confirmationDate">
              ÄÆ¡n hÃ ng sáº½ Ä‘Æ°á»£c giao cho Ä‘Æ¡n vá»‹ váº­n chuyá»ƒn trÆ°á»›c ngÃ y {{ getExpectedDeliveryDate(order.confirmationDate) }}
            </p>
            <p class="theo-doi-don-hang--ghi-chu" *ngIf="order.status !== 'ÄÃ£ há»§y' && order.status === 'Chá» giao hÃ ng'">
              Vui lÃ²ng chá»‰ nháº¥n "ÄÃ£ nháº­n Ä‘Æ°á»£c hÃ ng" khi Ä‘Æ¡n hÃ ng Ä‘Ã£ Ä‘Æ°á»£c giao Ä‘áº¿n báº¡n vÃ  sáº£n pháº©m nháº­n Ä‘Æ°á»£c khÃ´ng cÃ³ váº¥n Ä‘á» nÃ o
            </p>
            <p class="theo-doi-don-hang--ghi-chu" *ngIf="order.status !== 'ÄÃ£ há»§y' && order.status === 'HoÃ n thÃ nh' && !order.isRated">
              Vui lÃ²ng Ä‘Ã¡nh giÃ¡ sáº£n pháº©m
            </p>
          </div>
          <!-- NÃºt hÃ nh Ä‘á»™ng -->
          <div class="theo-doi-don-hang--don-hang-hanh-dong">
            <!-- NÃºt Ä‘áº§u tiÃªn thay Ä‘á»•i theo tráº¡ng thÃ¡i -->
            <button *ngIf="order.status === 'cho-xac-nhan'" class="theo-doi-don-hang--don-hang-button" (click)="openCancelPopup(order)">
              Há»§y Ä‘Æ¡n
            </button>
            <button *ngIf="order.status === 'van-chuyen' || order.status === 'cho-giao-hang'" class="theo-doi-don-hang--don-hang-button" [ngClass]="{'btn-disabled': !order.isDelivered}" [disabled]="!order.isDelivered" (click)="confirmReceived(order)">
              ÄÃ£ nháº­n hÃ ng
            </button>
            <button *ngIf="order.status === 'hoan-thanh' && !order.isRated" class="theo-doi-don-hang--don-hang-button" (click)="openRatingPopup(order)">
              ÄÃ¡nh giÃ¡
            </button>
            <button *ngIf="order.status === 'hoan-thanh' && order.isRated" class="theo-doi-don-hang--don-hang-button" (click)="viewRating(order)">
              Xem Ä‘Ã¡nh giÃ¡
            </button>
            <button *ngIf="order.status === 'da-huy'" class="theo-doi-don-hang--don-hang-button" (click)="buyAgain(order)">
              Mua láº¡i
            </button>

            <!-- NÃºt cá»‘ Ä‘á»‹nh "LiÃªn há»‡" -->
            <button class="theo-doi-don-hang--don-hang-button" [routerLink]="['/lien-he']">
              LiÃªn há»‡
            </button>
          </div>

          <!-- ThÃ nh tiá»n -->
          <div class="theo-doi-don-hang--don-hang-tong">
            <p class="theo-doi-don-hang--don-hang-tong">ThÃ nh tiá»n:</p>
            <p class="theo-doi-don-hang--don-hang-gia-tong">{{ order.totalPrice | number }}Ä‘</p>
          </div>
        </div>
      </div>
    </div>
    <!-- Ná»™i dung khÃ¡c (placeholder cho cÃ¡c section khÃ¡c) -->
    <!-- <div *ngIf="activeSection === 'tai-khoan-cua-toi'">Ná»™i dung TÃ i khoáº£n cá»§a tÃ´i</div>
    <div *ngIf="activeSection === 'viet-sach-truyen'">Ná»™i dung Viáº¿t sÃ¡ch/truyá»‡n</div>
    <div *ngIf="activeSection === 'dang-xuat'">
      <button (click)="onLogout()">XÃ¡c nháº­n Ä‘Äƒng xuáº¥t</button>
    </div> -->

  </div>
  
  <!-- Chi tiáº¿t Ä‘Æ¡n hÃ ng -->
<div class="thanh-don-hang" *ngIf="activeSection === 'chi-tiet-don-hang' && selectedOrder">
  <!-- Thanh trÃªn cÃ¹ng -->
  <div class="chi-tiet-don-hang--thanh-trang-thai">
    <div class="chi-tiet-don-hang--tro-lai" (click)="navigateToSection('theo-doi-don-hang')"> < TRá» Láº I</div>
    <div class="chi-tiet-don-hang--trang-thai">{{ getDetailedStatus(selectedOrder.status) | uppercase }}</div>
  </div>

  <!-- Ná»™i dung chi tiáº¿t -->
  <div class="chi-tiet-don-hang--noi-dung">
    <!-- Pháº§n head -->
    <div class="chi-tiet-don-hang--head">
      <p class="chi-tiet-don-hang--ma-don">MÃƒ ÄÆ N HÃ€NG: {{ selectedOrder.orderId }}</p>
      <p class="chi-tiet-don-hang--du-kien" *ngIf="selectedOrder.confirmationDate">
        ÄÆ¡n hÃ ng dá»± kiáº¿n Ä‘Æ°á»£c giao trÆ°á»›c ngÃ y {{ getExpectedDeliveryDate(selectedOrder.confirmationDate) }}
      </p>
    </div>

    <!-- Pháº§n tiáº¿n Ä‘á»™ Ä‘Æ¡n hÃ ng -->
     <div class="chi-tiet-don-hang--tien-do">
      <div class="chi-tiet-don-hang--tien-do-item">
        <img [src]="isStatusReached(selectedOrder, 'ÄÆ¡n hÃ ng Ä‘Ã£ Ä‘Æ°á»£c Ä‘áº·t thÃ nh cÃ´ng') ? 'dat-hang-thanh-cong-green.png' : 'dat-hang-thanh-cong-grey.png'" alt="Order Placed" class="chi-tiet-don-hang--tien-do-icon">
        <p class="chi-tiet-don-hang--tien-do-trang-thai">ÄÆ¡n hÃ ng Ä‘Ã£ Ä‘áº·t</p>
        <p class="chi-tiet-don-hang--tien-do-thoi-gian">{{ getStatusDate(selectedOrder, 'ÄÆ¡n hÃ ng Ä‘Ã£ Ä‘Æ°á»£c Ä‘áº·t thÃ nh cÃ´ng') }}</p>
      </div>
      <div class="chi-tiet-don-hang--tien-do-item">
        <img [src]="isStatusReached(selectedOrder, 'ÄÃ£ xÃ¡c nháº­n Ä‘Æ¡n hÃ ng') ? 'xac-nhan-green.png' : 'xac-nhan-gray.png'" alt="Confirmed" class="chi-tiet-don-hang--tien-do-icon">
        <p class="chi-tiet-don-hang--tien-do-trang-thai">ÄÃ£ xÃ¡c nháº­n Ä‘Æ¡n hÃ ng</p>
        <p class="chi-tiet-don-hang--tien-do-thoi-gian">{{ getStatusDate(selectedOrder, 'ÄÃ£ xÃ¡c nháº­n Ä‘Æ¡n hÃ ng') }}</p>
      </div>
      <div class="chi-tiet-don-hang--tien-do-item">
        <img [src]="isStatusReached(selectedOrder, 'ÄÃ£ giao cho Ä‘Æ¡n vá»‹ váº­n chuyá»ƒn') ? 'van-chuyen-green.png' : 'van-chuyen-gray.png'" alt="Delivered" class="chi-tiet-don-hang--tien-do-icon">
        <p class="chi-tiet-don-hang--tien-do-trang-thai">ÄÃ£ giao cho Ä‘Æ¡n vá»‹ váº­n chuyá»ƒn</p>
        <p class="chi-tiet-don-hang--tien-do-thoi-gian">{{ getStatusDate(selectedOrder, 'ÄÃ£ giao cho Ä‘Æ¡n vá»‹ váº­n chuyá»ƒn') }}</p>
      </div>
      <div class="chi-tiet-don-hang--tien-do-item">
        <img [src]="isStatusReached(selectedOrder, 'ÄÃ£ nháº­n Ä‘Æ°á»£c hÃ ng') ? 'nhan-hang-green.png' : 'nhan-hang-gray.png'" alt="Received" class="chi-tiet-don-hang--tien-do-icon">
        <p class="chi-tiet-don-hang--tien-do-trang-thai">ÄÃ£ nháº­n Ä‘Æ°á»£c hÃ ng</p>
        <p class="chi-tiet-don-hang--tien-do-thoi-gian">{{ getStatusDate(selectedOrder, 'ÄÃ£ nháº­n Ä‘Æ°á»£c hÃ ng') }}</p>
      </div>
      <div class="chi-tiet-don-hang--tien-do-item">
        <img [src]="isStatusReached(selectedOrder, 'ÄÃ¡nh giÃ¡') ? 'danh-gia-green.png' : 'danh-gia-gray.png'" alt="Rating" class="chi-tiet-don-hang--tien-do-icon">
        <p class="chi-tiet-don-hang--tien-do-trang-thai">ÄÃ¡nh giÃ¡</p>
        <p class="chi-tiet-don-hang--tien-do-thoi-gian">{{ getStatusDate(selectedOrder, 'ÄÃ¡nh giÃ¡') }}</p>
      </div>
    </div>

    <!-- Pháº§n lá»™ trÃ¬nh Ä‘Æ¡n hÃ ng -->
    <div class="chi-tiet-don-hang--lo-trinh">
      <h3 class="chi-tiet-don-hang--lo-trinh-tieu-de">Lá»™ trÃ¬nh Ä‘Æ¡n hÃ ng</h3>
      <div class="chi-tiet-don-hang--lo-trinh-noi-dung">
        <div class="chi-tiet-don-hang--lo-trinh-thoi-gian">
          <p *ngFor="let entry of selectedOrder.timeline">{{ entry.date }}</p>
        </div>
        <div class="chi-tiet-don-hang--lo-trinh-mo-ta">
          <p *ngFor="let entry of selectedOrder.timeline">{{ entry.action }}</p>
        </div>
      </div>
    </div>

    <!-- ÄÆ°á»ng phÃ¢n cÃ¡ch -->
    <hr class="theo-doi-don-hang--separator">

    <!-- Pháº§n chi tiáº¿t Ä‘Æ¡n hÃ ng -->
    <div class="chi-tiet-don-hang--chi-tiet">
      <h3 class="chi-tiet-don-hang--chi-tiet-tieu-de">Chi tiáº¿t Ä‘Æ¡n hÃ ng</h3>
      <p class="chi-tiet-don-hang--dia-chi-tieu-de">Äá»‹a chá»‰ nháº­n hÃ ng</p>
      <p class="chi-tiet-don-hang--dia-chi">{{ selectedOrder.addressName }}</p>
      <p class="chi-tiet-don-hang--dia-chi">{{ selectedOrder.addressPhone }}</p>
      <p class="chi-tiet-don-hang--dia-chi">{{ selectedOrder.addressLocation }}</p>

      <div class="chi-tiet-don-hang--san-pham">
        <img [src]="selectedOrder.imageUrl" [alt]="selectedOrder.title" class="chi-tiet-don-hang--san-pham-anh">
        <div class="chi-tiet-don-hang--san-pham-chi-tiet">
          <div class="chi-tiet-don-hang--san-pham-hang">
            <h3 class="chi-tiet-don-hang--san-pham-tieu-de">{{ selectedOrder.title }}</h3>
            <div></div>
          </div>
          <div class="chi-tiet-don-hang--san-pham-hang">
            <p class="chi-tiet-don-hang--san-pham-so-luong">Sá»‘ lÆ°á»£ng: {{ selectedOrder.quantity }}</p>
            <p class="chi-tiet-don-hang--san-pham-gia">
              <span class="gia-goc">{{ selectedOrder.originalPrice | number }}Ä‘</span> {{ selectedOrder.discountedPrice | number }}Ä‘
            </p>
          </div>
        </div>
      </div>
    </div>

    <!-- ÄÆ°á»ng phÃ¢n cÃ¡ch -->
    <hr class="theo-doi-don-hang--separator">

    <!-- Pháº§n chi phÃ­ -->
    <div class="chi-tiet-don-hang--chi-phi">
      <div class="chi-tiet-don-hang--chi-phi-cot-trong"></div>
      <div class="chi-tiet-don-hang--chi-phi-ten">
        <p>Tá»•ng tiá»n hÃ ng:</p>
        <p>PhÃ­ váº­n chuyá»ƒn:</p>
        <p>Giáº£m giÃ¡:</p>
        <p>ThÃ nh tiá»n:</p>
        <p>PhÆ°Æ¡ng thá»©c thanh toÃ¡n:</p>
      </div>
      <div class="chi-tiet-don-hang--chi-phi-gia">
        <p>{{ (selectedOrder.discountedPrice * selectedOrder.quantity) | number }}Ä‘</p>
        <p>{{ selectedOrder.shippingFee | number }}Ä‘</p>
        <p>{{ selectedOrder.discount | number }}Ä‘</p>
        <p>{{ selectedOrder.totalPrice | number }}Ä‘</p>
        <p>{{ selectedOrder.paymentMethod }}</p>
      </div>
    </div>

    <!-- NÃºt hÃ nh Ä‘á»™ng -->
    <div class="chi-tiet-don-hang--hanh-dong">
      <button *ngIf="selectedOrder.status === 'cho-xac-nhan'" class="theo-doi-don-hang--don-hang-button" (click)="openCancelPopup(selectedOrder)">
        Há»§y Ä‘Æ¡n
      </button>
      <button *ngIf="selectedOrder.status === 'van-chuyen' || selectedOrder.status === 'cho-giao-hang'" class="theo-doi-don-hang--don-hang-button" [ngClass]="{'btn-disabled': !selectedOrder.isDelivered}" [disabled]="!selectedOrder.isDelivered" (click)="confirmReceived(selectedOrder)">
        ÄÃ£ nháº­n hÃ ng
      </button>
      <button *ngIf="selectedOrder.status === 'hoan-thanh' && !selectedOrder.isRated" class="theo-doi-don-hang--don-hang-button" (click)="openRatingPopup(selectedOrder)">
        ÄÃ¡nh giÃ¡
      </button>
      <button *ngIf="selectedOrder.status === 'hoan-thanh' && selectedOrder.isRated" class="theo-doi-don-hang--don-hang-button" (click)="viewRating(selectedOrder)">
        Xem Ä‘Ã¡nh giÃ¡
      </button>
      <button *ngIf="selectedOrder.status === 'da-huy'" class="theo-doi-don-hang--don-hang-button" (click)="buyAgain(selectedOrder)">
        Mua láº¡i
      </button>
      <button class="theo-doi-don-hang--don-hang-button" [routerLink]="['/lien-he']">
        LiÃªn há»‡
      </button>
    </div>
  </div>
</div>
</div>

<!-- Popup Ä‘Ã¡nh giÃ¡ -->
<div class="rating-popup-overlay" *ngIf="showRatingPopup" (click)="closeRatingPopup()"></div>
<div class="rating-popup" *ngIf="showRatingPopup">
  <h3 class="rating-popup--title">ÄÃ¡nh GiÃ¡ Sáº£n Pháº©m</h3>
  <div class="rating-popup--product">
    <img [src]="ratingOrder?.imageUrl" [alt]="ratingOrder?.title" class="rating-popup--product-image">
    <div class="rating-popup--product-details">
      <p class="rating-popup--product-title">{{ ratingOrder?.title }}</p>
      <p class="rating-popup--product-quantity">Sá»‘ lÆ°á»£ng: {{ ratingOrder?.quantity }}</p>
    </div>
  </div>
  <div class="rating-popup--stars">
    <span class="rating-popup--stars-label">Cháº¥t lÆ°á»£ng sáº£n pháº©m</span>
    <div class="rating-popup--stars-container">
      <span
        *ngFor="let star of [1, 2, 3, 4, 5]; let i = index"
        class="rating-popup--star"
        [ngClass]="{'filled': i + 1 <= (hoverRating || currentRating)}"
        (mouseover)="onStarHover(i + 1)"
        (mouseleave)="onStarLeave()"
        (click)="onStarClick(i + 1)"
      >â˜…</span>
    </div>
    <span class="rating-popup--stars-text">{{ getRatingText(hoverRating || currentRating) }}</span>
  </div>
  <textarea
    class="rating-popup--textarea"
    placeholder="HÃ£y chia sáº» nháº­n Ä‘á»‹nh cá»§a báº¡n thÃ­ch vá» sáº£n pháº©m nÃ y vá»›i nhá»¯ng ngÆ°á»i mua khÃ¡c nhÃ©"
    [(ngModel)]="ratingText"
  ></textarea>
  <div class="rating-popup--actions">
    <button class="rating-popup--button rating-popup--button-cancel" (click)="closeRatingPopup()">Quay láº¡i</button>
    <button class="rating-popup--button rating-popup--button-submit" (click)="submitRating()">Gá»­i Ä‘Ã¡nh giÃ¡</button>
  </div>
</div>

<!-- Popup thÃ´ng bÃ¡o thÃ nh cÃ´ng -->
<div class="success-popup" *ngIf="showSuccessPopup">
  <div class="success-popup--icon"><img src="danh-gia-thanh-cong.png" alt="" class="success-popup--icon"></div>
  <p class="success-popup--message">Cáº£m Æ¡n báº¡n Ä‘Ã£ Ä‘Ã¡nh giÃ¡!</p>
</div>

<!-- Popup xem Ä‘Ã¡nh giÃ¡ -->
<div class="view-rating-popup-overlay" *ngIf="showViewRatingPopup" (click)="closeViewRatingPopup()"></div>
<div class="view-rating-popup" *ngIf="showViewRatingPopup">
  <h3 class="view-rating-popup--title">ÄÃ¡nh giÃ¡ cá»§a tÃ´i</h3>
  <div class="view-rating-popup--product">
    <img [src]="ratingOrder?.imageUrl" [alt]="ratingOrder?.title" class="view-rating-popup--product-image">
    <div class="view-rating-popup--product-details">
      <p class="view-rating-popup--product-title">{{ ratingOrder?.title }}</p>
      <p class="view-rating-popup--product-quantity">Sá»‘ lÆ°á»£ng: {{ ratingOrder?.quantity }}</p>
    </div>
  </div>
  <hr class="view-rating-popup--separator">
  <div class="view-rating-popup--review">
    <div class="view-rating-popup--user">
      <div class="view-rating-popup--user-avatar"></div>
      <div class="view-rating-popup--user-details">
        <p class="view-rating-popup--user-name">nguyenngoctrinh</p>
        <div class="view-rating-popup--user-stars">
          <span *ngFor="let star of [1, 2, 3, 4, 5]; let i = index"
                class="view-rating-popup--star"
                [ngClass]="{'filled': i + 1 <= (ratingOrder?.rating || 0)}">â˜…</span>
        </div>
      </div>
    </div>
    <p class="view-rating-popup--review-text">{{ ratingOrder?.ratingText }}</p>
    <p class="view-rating-popup--review-date">{{ ratingOrder?.ratingDate }}</p>
  </div>
  <div class="view-rating-popup--actions">
    <button *ngIf="ratingOrder && !ratingOrder.isEdited" class="view-rating-popup--button view-rating-popup--button-edit" (click)="openEditRatingPopup(ratingOrder!)">Sá»­a</button>
    <button class="view-rating-popup--button view-rating-popup--button-close" (click)="closeViewRatingPopup()">ThoÃ¡t</button>
  </div>
</div>

<!-- Popup sá»­a Ä‘Ã¡nh giÃ¡ -->
<div class="rating-popup-overlay" *ngIf="showEditRatingPopup" (click)="closeRatingPopup()"></div>
<div class="rating-popup" *ngIf="showEditRatingPopup">
  <h3 class="rating-popup--title">Sá»­a ÄÃ¡nh GiÃ¡ Sáº£n Pháº©m</h3>
  <div class="rating-popup--product">
    <img [src]="ratingOrder?.imageUrl" [alt]="ratingOrder?.title" class="rating-popup--product-image">
    <div class="rating-popup--product-details">
      <p class="rating-popup--product-title">{{ ratingOrder?.title }}</p>
      <p class="rating-popup--product-quantity">Sá»‘ lÆ°á»£ng: {{ ratingOrder?.quantity }}</p>
    </div>
  </div>
  <div class="rating-popup--stars">
    <span class="rating-popup--stars-label">Cháº¥t lÆ°á»£ng sáº£n pháº©m</span>
    <div class="rating-popup--stars-container">
      <span
        *ngFor="let star of [1, 2, 3, 4, 5]; let i = index"
        class="rating-popup--star"
        [ngClass]="{'filled': i + 1 <= (hoverRating || currentRating)}"
        (mouseover)="onStarHover(i + 1)"
        (mouseleave)="onStarLeave()"
        (click)="onStarClick(i + 1)"
      >â˜…</span>
    </div>
    <span class="rating-popup--stars-text">{{ getRatingText(hoverRating || currentRating) }}</span>
  </div>
  <textarea
    class="rating-popup--textarea"
    placeholder="HÃ£y chia sáº» nháº­n Ä‘á»‹nh cá»§a báº¡n thÃ­ch vá» sáº£n pháº©m nÃ y vá»›i nhá»¯ng ngÆ°á»i mua khÃ¡c nhÃ©"
    [(ngModel)]="ratingText"
  ></textarea>
  <div class="rating-popup--actions">
    <button class="rating-popup--button rating-popup--button-cancel" (click)="cancelEditRating()">Quay láº¡i</button>
    <button class="rating-popup--button rating-popup--button-submit" (click)="updateRating()">Cáº­p nháº­t</button>
  </div>
</div>

<!-- Popup "LÃ½ do há»§y" -->
<div class="cancel-popup-overlay" *ngIf="showCancelPopup" (click)="closeCancelPopup()"></div>
<div class="cancel-popup" *ngIf="showCancelPopup">
  <h3 class="cancel-popup--title">LÃ½ do há»§y</h3>
  <p class="cancel-popup--message">Náº¿u báº¡n xÃ¡c nháº­n há»§y, toÃ n bá»™ Ä‘Æ¡n hÃ ng sáº½ Ä‘Æ°á»£c há»§y. TrÆ°á»ng há»£p báº¡n Ä‘Ã£ thanh toÃ¡n, tiá»n sáº½ Ä‘Æ°á»£c hoÃ n vá» vÃ­ tÃ i khoáº£n ngÃ¢n hÃ ng cá»§a báº¡n trong vÃ²ng 24 giá». Má»i váº¥n Ä‘á» vá» hoÃ n tiá»n, báº¡n vui lÃ²ng liÃªn há»‡ chÃºng tÃ´i Ä‘á»ƒ Ä‘Æ°á»£c há»— trá»£.</p>
  <div class="cancel-popup--options">
    <label class="cancel-popup--option">
      <input type="radio" name="cancelReason" value="TÃ´i tÃ¬m tháº¥y sáº£n pháº©m ráº» hÆ¡n" [(ngModel)]="cancelReason">
      TÃ´i tÃ¬m tháº¥y sáº£n pháº©m ráº» hÆ¡n
    </label>
    <label class="cancel-popup--option">
      <input type="radio" name="cancelReason" value="NgÆ°á»i bÃ¡n khÃ´ng tráº£ lá»i tháº¯c máº¯c, yÃªu cáº§u cá»§a tÃ´i" [(ngModel)]="cancelReason">
      NgÆ°á»i bÃ¡n khÃ´ng tráº£ lá»i tháº¯c máº¯c, yÃªu cáº§u cá»§a tÃ´i
    </label>
    <label class="cancel-popup--option">
      <input type="radio" name="cancelReason" value="TÃ´i muá»‘n thay Ä‘á»•i Ä‘á»‹a chá»‰ giao hÃ ng (sá»‘ lÆ°á»£ng, thÃªm, giáº£m giÃ¡...)" [(ngModel)]="cancelReason">
      TÃ´i muá»‘n thay Ä‘á»•i Ä‘á»‹a chá»‰ giao hÃ ng (sá»‘ lÆ°á»£ng, thÃªm, giáº£m giÃ¡...)
    </label>
    <label class="cancel-popup--option">
      <input type="radio" name="cancelReason" value="TÃ´i khÃ´ng cáº§n nhu cáº§u mua ná»¯a" [(ngModel)]="cancelReason">
      TÃ´i khÃ´ng cáº§n nhu cáº§u mua ná»¯a
    </label>
  </div>
  <div class="cancel-popup--actions">
    <button class="cancel-popup--button cancel-popup--button-back" (click)="closeCancelPopup()">Quay láº¡i</button>
    <button class="cancel-popup--button cancel-popup--button-confirm" (click)="confirmCancelOrder()">Há»§y Ä‘Æ¡n</button>
  </div>
</div>

<!-- Popup "Há»§y Ä‘Æ¡n thÃ nh cÃ´ng" -->
<div class="cancel-success-popup" *ngIf="showCancelSuccessPopup">
  <div class="cancel-success-popup--icon"><img src="danh-gia-thanh-cong.png" alt=""></div>
  <p class="cancel-success-popup--message">Há»§y Ä‘Æ¡n thÃ nh cÃ´ng</p>
  <p *ngIf="cancelOrderToProcess?.paymentMethod === 'Chuyá»ƒn khoáº£n ngÃ¢n hÃ ng'" class="cancel-success-popup--submessage">
    Tiá»n sáº½ Ä‘Æ°á»£c hoÃ n vá» vÃ­ tÃ i khoáº£n ngÃ¢n hÃ ng cá»§a báº¡n trong vÃ²ng 24 giá».
  </p>
</div>



